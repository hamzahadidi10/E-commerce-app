<ng-container *ngIf="product$ | async as product; else loading">
  <div class="container my-5 product-details-container">
    <div class="row">
      <!-- Image -->
      <div class="col-md-6 text-center">
        <img [src]="product.productImageUrl" 
             alt="{{ product.productName }}" 
             class="img-fluid rounded product-image" />
      </div>

      <!-- Info -->
      <div class="col-md-6">
        <h2 class="text-black">{{ product.productName }}</h2>
        <p class="text-muted">Category: {{ product.category }}</p>
        <p class="text-dark">{{ product.description }}</p>

        <h4 class="text-success">{{ product.price }} DT</h4>

        <p *ngIf="product.stock > 0" class="text-success">In Stock</p>
        <p *ngIf="product.stock === 0" class="text-danger">Out of Stock</p>

        <!-- Size Selection -->
<div class="my-3">
  <label class="form-label fw-bold">Select Size:</label><br />
  <div class="btn-group" role="group">
    <input type="radio" class="btn-check" name="size" id="size-s" (change)="selectSize('S')" />
    <label class="btn btn-outline-dark" for="size-s"> S </label>

    <input type="radio" class="btn-check" name="size" id="size-m" (change)="selectSize('M')" />
    <label class="btn btn-outline-dark" for="size-m"> M </label>

    <input type="radio" class="btn-check" name="size" id="size-l" (change)="selectSize('L')" />
    <label class="btn btn-outline-dark" for="size-l"> L </label>

    <input type="radio" class="btn-check" name="size" id="size-xl"  (change)="selectSize('XL')" />
    <label class="btn btn-outline-dark" for="size-xl"> XL </label>
  </div>
</div>

<p *ngIf="addCartMessage" class="text-danger">{{ addCartMessage }}</p>

<!-- Buttons -->
<button class="btn btn-success mt-3" (click)="addToCart(product)" *ngIf="activeUser?.role === 'user'">Add to Cart</button>
<button class="btn btn-secondary mt-3" routerLink="/shop">Back to Shop</button>
      </div>
    </div>
  </div>
</ng-container>

<ng-template #loading>
  <div class="text-center my-5">
    <div class="spinner-border text-success" role="status"></div>
    <p class="mt-3">Loading product details...</p>
  </div>
</ng-template>
